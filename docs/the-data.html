<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 2 The data | Statistical tests as linear models</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 2 The data | Statistical tests as linear models" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 The data | Statistical tests as linear models" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Steve Doogue">


<meta name="date" content="2019-04-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="the-simple-linear-model.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>2</b> The data</a><ul>
<li class="chapter" data-level="2.1" data-path="the-data.html"><a href="the-data.html#sample-values"><i class="fa fa-check"></i><b>2.1</b> Sample values</a></li>
<li class="chapter" data-level="2.2" data-path="the-data.html"><a href="the-data.html#rank_trans"><i class="fa fa-check"></i><b>2.2</b> Rank-transformed values</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-simple-linear-model.html"><a href="the-simple-linear-model.html"><i class="fa fa-check"></i><b>3</b> The simple linear model</a><ul>
<li class="chapter" data-level="3.1" data-path="the-simple-linear-model.html"><a href="the-simple-linear-model.html#pearson-correlation"><i class="fa fa-check"></i><b>3.1</b> Pearson correlation</a></li>
<li class="chapter" data-level="3.2" data-path="the-simple-linear-model.html"><a href="the-simple-linear-model.html#spearman-correlation"><i class="fa fa-check"></i><b>3.2</b> Spearman correlation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="appendix-1-types-of-variables.html"><a href="appendix-1-types-of-variables.html"><i class="fa fa-check"></i><b>4</b> Appendix 1 - Types of variables</a><ul>
<li class="chapter" data-level="4.1" data-path="appendix-1-types-of-variables.html"><a href="appendix-1-types-of-variables.html#discrete-variables"><i class="fa fa-check"></i><b>4.1</b> Discrete variables</a></li>
<li class="chapter" data-level="4.2" data-path="appendix-1-types-of-variables.html"><a href="appendix-1-types-of-variables.html#continuous-variables"><i class="fa fa-check"></i><b>4.2</b> Continuous variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>5</b> Introduction</a></li>
<li class="chapter" data-level="6" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>6</b> Literature</a></li>
<li class="chapter" data-level="7" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>7</b> Methods</a></li>
<li class="chapter" data-level="8" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>8</b> Applications</a><ul>
<li class="chapter" data-level="8.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>8.1</b> Example one</a></li>
<li class="chapter" data-level="8.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>8.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>9</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical tests as linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-data" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> The data</h1>
<div id="sample-values" class="section level2">
<h2><span class="header-section-number">2.1</span> Sample values</h2>
<p>Most of the examples in the book are based on three imaginary samples (<code>x</code>, <code>y</code> and <code>y2</code>). Each is normally distributed and is made up of 50 observations:</p>
<ul>
<li><code>x</code> has a mean of 0 and a standard deviation of 1</li>
<li><code>y</code> has a mean of 0.3 and a standard deviation of 2</li>
<li><code>y2</code>has a mean of 0.5 and a standard deviation of 1.5</li>
</ul>
<p><code>x</code> and <code>y</code> can be thought of as samples from different populations (e.g. 50 women and 50 men), while <code>y</code> and <code>y2</code> are samples of the same individuals at different points in time (the same 50 men before and after participating in a new drug trial).</p>
<p>We begin by creating a function that will allow us to produce samples of a given size (<code>N</code>) with a specified mean (<code>mu</code>) and standard deviation (<code>sd</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
rnorm_fixed =<span class="st"> </span><span class="cf">function</span>(N, <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>){<span class="kw">scale</span>(<span class="kw">rnorm</span>(N))<span class="op">*</span>sd <span class="op">+</span><span class="st"> </span>mu}</code></pre></div>
<p>Now we can create our three samples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set the seed so our &#39;random&#39; results match those in the original book</span>
<span class="kw">set.seed</span>(<span class="dv">40</span>)

<span class="co"># Create the samples:</span>
x =<span class="st"> </span><span class="kw">rnorm_fixed</span>(<span class="dt">N =</span> <span class="dv">50</span>, <span class="dt">mu=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>)
y =<span class="st"> </span><span class="kw">rnorm_fixed</span>(<span class="dt">N =</span> <span class="dv">50</span>, <span class="dt">mu=</span><span class="fl">0.3</span>, <span class="dt">sd=</span><span class="dv">2</span>)
y2 =<span class="st"> </span><span class="kw">rnorm_fixed</span>(<span class="dt">N =</span> <span class="dv">50</span>, <span class="dt">mu=</span><span class="fl">0.5</span>, <span class="dt">sd=</span><span class="fl">1.5</span>)</code></pre></div>
<p>Lets also combine these samples into ‘wide’ and ‘long’ data frames. This doesn’t change any of the values, it just rearranges to data into different layouts which can sometimes be easier to work with (e.g. when producing plots):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The wide layout is a dataframe with three columns, one for each of x, y and y2</span>
mydata_wide &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">y2 =</span> y2)

<span class="co"># the long layout has two columns: one listing the group to which each observation </span>
<span class="co"># belongs (x, y or y2), and another column with the corresponding value</span>
mydata_long &lt;-<span class="st"> </span>mydata_wide <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(group,value,x<span class="op">:</span>y2)</code></pre></div>
<p>Here’s what our three samples look like when plotted. Note the different mean (0.0, 0.3 and 0.5) and the different ‘spread’ of values for each group (reflecting their different standard deviations).</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="stat_tests_files/figure-html/unnamed-chunk-4-1.png" alt="Our sample data" width="480" />
<p class="caption">
Figure 2.1: Our sample data
</p>
</div>
</div>
<div id="rank_trans" class="section level2">
<h2><span class="header-section-number">2.2</span> Rank-transformed values</h2>
<p>Most common tests demonstrated in the book use the <em>actual</em> values from the samples above. However, some tests also use their <em>rank-transformed</em> values. Specifically, the <em>signed rank</em> of the values is used.</p>
<p>What is meant by signed ranks? The signed rank is found by:<br />
1. taking the <em>absolute</em> value of each observation in the original sample; that is, expressing all the values as a positive number;<br />
2. finding the rank of each of these absolute values, where the smallest absolute value has a rank of 1; and<br />
3. giving each of these ranks the same sign (+ or -) as the original value.</p>
<p>For example, the numbers -2, 3, 7, -25, -30, 31 would have the signed ranks of -1, 2, 3, -4, -5, 6.</p>
<p>We create a function, <code>signed_rank()</code>, that we can use later to convert our actual values into signed ranks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Takes any list of values, x, and calculates their signed rank</span>
signed_rank =<span class="st"> </span><span class="cf">function</span>(x) {<span class="kw">sign</span>(x) <span class="op">*</span><span class="st"> </span><span class="kw">rank</span>(<span class="kw">abs</span>(x))}</code></pre></div>
<p>Here is what our sample data would look like if we used signed ranks instead of actual values (I have remove the horizonal ‘jitter’ from this chart). Because each sample has 50 observations, each signed rank is somewhere between -50 and +50:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-6"></span>
<img src="stat_tests_files/figure-html/unnamed-chunk-6-1.png" alt="Our sample data, with signed ranks" width="480" />
<p class="caption">
Figure 2.2: Our sample data, with signed ranks
</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-simple-linear-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["stat_tests.pdf", "stat_tests.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
